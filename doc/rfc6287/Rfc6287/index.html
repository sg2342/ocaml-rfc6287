<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Rfc6287 (rfc6287.Rfc6287)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">rfc6287</a> &#x00BB; Rfc6287</nav><h1>Module <code>Rfc6287</code></h1><p>RFC6287 (OCRA)</p><dl><dt>see <a href="http://tools.ietf.org/html/rfc6287">http://tools.ietf.org/html/rfc6287</a></dt><dd><p>RFC6287</p></dd></dl><dl><dt>see <a href="https://www.rfc-editor.org/errata_search.php?eid=3729">https://www.rfc-editor.org/errata_search.php?eid=3729</a></dt><dd><p>Errata 3729</p></dd></dl></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>The abstract OCRA <code>suite</code> type</p></dd></dl><dl><dt class="spec type" id="type-err"><a href="#type-err" class="anchor"></a><code><span class="keyword">type</span> err</code><code> = </code><table class="variant"><tr id="type-err.Invalid_suite_string" class="anchored"><td class="def constructor"><a href="#type-err.Invalid_suite_string" class="anchor"></a><code>| </code><code><span class="constructor">Invalid_suite_string</span></code></td></tr><tr id="type-err.DataInput" class="anchored"><td class="def constructor"><a href="#type-err.DataInput" class="anchor"></a><code>| </code><code><span class="constructor">DataInput</span> <span class="keyword">of</span> string</code></td></tr><tr id="type-err.Window" class="anchored"><td class="def constructor"><a href="#type-err.Window" class="anchor"></a><code>| </code><code><span class="constructor">Window</span> <span class="keyword">of</span> string</code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-t_of_string"><a href="#val-t_of_string" class="anchor"></a><code><span class="keyword">val</span> t_of_string : string <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <a href="index.html#type-err">err</a>)</span> Rresult.result</span></code></dt><dt class="spec value" id="val-string_of_t"><a href="#val-string_of_t" class="anchor"></a><code><span class="keyword">val</span> string_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt></dl><dl><dt class="spec type" id="type-di"><a href="#type-di" class="anchor"></a><code><span class="keyword">type</span> di</code><code> = </code><code>{</code><table class="record"><tr id="type-di.c" class="anchored"><td class="def field"><a href="#type-di.c" class="anchor"></a><code>c : bool;</code></td><td class="doc"><p>C</p></td></tr><tr id="type-di.q" class="anchored"><td class="def field"><a href="#type-di.q" class="anchor"></a><code>q : <span>[ `A <span>| `N</span> <span>| `H</span> ]</span> * int;</code></td><td class="doc"><p>Q</p></td></tr><tr id="type-di.p" class="anchored"><td class="def field"><a href="#type-di.p" class="anchor"></a><code>p : <span><span>[ `SHA1 <span>| `SHA256</span> <span>| `SHA512</span> ]</span> option</span>;</code></td><td class="doc"><p>P</p></td></tr><tr id="type-di.s" class="anchored"><td class="def field"><a href="#type-di.s" class="anchor"></a><code>s : <span>int option</span>;</code></td><td class="doc"><p>S</p></td></tr><tr id="type-di.t" class="anchored"><td class="def field"><a href="#type-di.t" class="anchor"></a><code>t : <span>int option</span>;</code></td><td class="doc"><p>T</p></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-di_of_t"><a href="#val-di_of_t" class="anchor"></a><code><span class="keyword">val</span> di_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-di">di</a></code></dt><dd><dl><dt>returns</dt><dd><p>DataInput spec</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-challenge"><a href="#val-challenge" class="anchor"></a><code><span class="keyword">val</span> challenge : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><dl><dt>returns</dt><dd><p>random challenge string <code>q</code> with format and length as specified in <code>suite</code></p></dd></dl></dd></dl><dl><dt class="spec type" id="type-pinhash"><a href="#type-pinhash" class="anchor"></a><code><span class="keyword">type</span> pinhash</code> = <code>[ </code><table class="variant"><tr id="type-pinhash.String" class="anchored"><td class="def constructor"><a href="#type-pinhash.String" class="anchor"></a><code>| </code><code>`String <span class="keyword">of</span> string</code></td></tr><tr id="type-pinhash.Digest" class="anchored"><td class="def constructor"><a href="#type-pinhash.Digest" class="anchor"></a><code>| </code><code>`Digest <span class="keyword">of</span> Cstruct.t</code></td></tr></table><code> ]</code></dt><dd><p>if pinhash is <code>`String x</code>, <a href="index.html#val-gen"><code>gen</code></a> and <a href="index.html#val-verify"><code>verify</code></a> will apply the Pin Hash algorithm specified in <code>suite</code> to calculate the digest of x.</p><p>if pinhash is <code>`Digest d</code>, its length must equal digests size of Pin Hash function (as specified in <code>suite</code>)</p></dd></dl><dl><dt class="spec type" id="type-timestamp"><a href="#type-timestamp" class="anchor"></a><code><span class="keyword">type</span> timestamp</code> = <code>[ </code><table class="variant"><tr id="type-timestamp.Now" class="anchored"><td class="def constructor"><a href="#type-timestamp.Now" class="anchor"></a><code>| </code><code>`Now</code></td></tr><tr id="type-timestamp.Int64" class="anchored"><td class="def constructor"><a href="#type-timestamp.Int64" class="anchor"></a><code>| </code><code>`Int64 <span class="keyword">of</span> int64</code></td></tr></table><code> ]</code></dt><dd><p>if timestamp is <code>`Now</code>, <a href="index.html#val-gen"><code>gen</code></a> and <a href="index.html#val-verify"><code>verify</code></a> will use <span class="xref-unresolved" title="unresolved reference to &quot;Unix.time&quot;"><code>Unix</code>.time</span> and the timestep specified in <code>suite</code> to calculate the timestamp value</p></dd></dl><dl><dt class="spec value" id="val-gen"><a href="#val-gen" class="anchor"></a><code><span class="keyword">val</span> gen : <span>?&#8288;time:int64</span> <span>&#45;&gt;</span> <span>?&#8288;c:int64</span> <span>&#45;&gt;</span> <span>?&#8288;p:<a href="index.html#type-pinhash">pinhash</a></span> <span>&#45;&gt;</span> <span>?&#8288;s:Cstruct.t</span> <span>&#45;&gt;</span> <span>?&#8288;t:<a href="index.html#type-timestamp">timestamp</a></span> <span>&#45;&gt;</span> <span>key:Cstruct.t</span> <span>&#45;&gt;</span> <span>q:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(Cstruct.t, <a href="index.html#type-err">err</a>)</span> Rresult.result</span></code></dt><dd><p>Generate <code>OCRA(K, {[C] | Q | [P | S | T]})</code>.</p><dl><dt>returns</dt><dd><ul><li><code>Ok a</code> the response</li><li><code>Error (DataInput error_message)</code> if parameters do not match <code>suite</code></li></ul></dd></dl><dl><dt>parameter c</dt><dd><p>DataInput C: Counter</p></dd></dl><dl><dt>parameter p</dt><dd><p>DataInput P: Pin Hash</p></dd></dl><dl><dt>parameter s</dt><dd><p>DataInput S: Session; length must equal session size (as specified in <code>suite</code>)</p></dd></dl><dl><dt>parameter t</dt><dd><p>DataInput T: Timestamp</p></dd></dl><dl><dt>parameter key</dt><dd><p>CryptoFunction key K</p></dd></dl><dl><dt>parameter q</dt><dd><p>DataInput Q: Challenge</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-gen1"><a href="#val-gen1" class="anchor"></a><code><span class="keyword">val</span> gen1 : <span>?&#8288;time:int64</span> <span>&#45;&gt;</span> <span>c:<span>int64 option</span></span> <span>&#45;&gt;</span> <span>p:<span><a href="index.html#type-pinhash">pinhash</a> option</span></span> <span>&#45;&gt;</span> <span>s:<span>Cstruct.t option</span></span> <span>&#45;&gt;</span> <span>t:<span><a href="index.html#type-timestamp">timestamp</a> option</span></span> <span>&#45;&gt;</span> <span>key:Cstruct.t</span> <span>&#45;&gt;</span> <span>q:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(Cstruct.t, <a href="index.html#type-err">err</a>)</span> Rresult.result</span></code></dt><dt class="spec value" id="val-verify"><a href="#val-verify" class="anchor"></a><code><span class="keyword">val</span> verify : <span>?&#8288;time:int64</span> <span>&#45;&gt;</span> <span>?&#8288;c:int64</span> <span>&#45;&gt;</span> <span>?&#8288;p:<a href="index.html#type-pinhash">pinhash</a></span> <span>&#45;&gt;</span> <span>?&#8288;s:Cstruct.t</span> <span>&#45;&gt;</span> <span>?&#8288;t:<a href="index.html#type-timestamp">timestamp</a></span> <span>&#45;&gt;</span> <span>?&#8288;cw:int</span> <span>&#45;&gt;</span> <span>?&#8288;tw:int</span> <span>&#45;&gt;</span> <span>key:Cstruct.t</span> <span>&#45;&gt;</span> <span>q:string</span> <span>&#45;&gt;</span> <span>a:Cstruct.t</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(bool * <span>int64 option</span>, <a href="index.html#type-err">err</a>)</span> Rresult.result</span></code></dt><dd><p>Verify OCRA Response.</p><dl><dt>returns</dt><dd><ul><li><code>Ok (true, None)</code> upon successful verification for <code>suite</code> without <code>C</code> DataInput</li><li><code>Ok (true, Some next_counter)</code> upon successful verification for <code>suite</code> with <code>C</code> DataInput</li><li><code>Ok (false, None)</code> if verification failed</li><li><code>Error (DataInput error_message)</code> if parameters do not match <code>suite</code></li><li><code>Error (Window error_message)</code> on invalid <code>cw</code> and <code>tw</code> parameters</li></ul></dd></dl><dl><dt>parameter c</dt><dd><p>DataInput C: Counter</p></dd></dl><dl><dt>parameter p</dt><dd><p>DataInput P: Pin Hash</p></dd></dl><dl><dt>parameter s</dt><dd><p>DataInput S: Session; length must equal session size (as specified in <code>suite</code>)</p></dd></dl><dl><dt>parameter t</dt><dd><p>DataInput T: Timestamp</p></dd></dl><dl><dt>parameter cw</dt><dd><p>Counter Window</p></dd></dl><dl><dt>parameter tw</dt><dd><p>Timestamp Window</p></dd></dl><dl><dt>parameter key</dt><dd><p>CryptoFunction key K</p></dd></dl><dl><dt>parameter q</dt><dd><p>DataInput Q: Challenge</p></dd></dl><dl><dt>parameter a</dt><dd><p>Response to check against</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-verify1"><a href="#val-verify1" class="anchor"></a><code><span class="keyword">val</span> verify1 : <span>?&#8288;time:int64</span> <span>&#45;&gt;</span> <span>c:<span>int64 option</span></span> <span>&#45;&gt;</span> <span>p:<span><a href="index.html#type-pinhash">pinhash</a> option</span></span> <span>&#45;&gt;</span> <span>s:<span>Cstruct.t option</span></span> <span>&#45;&gt;</span> <span>t:<span><a href="index.html#type-timestamp">timestamp</a> option</span></span> <span>&#45;&gt;</span> <span>cw:<span>int option</span></span> <span>&#45;&gt;</span> <span>tw:<span>int option</span></span> <span>&#45;&gt;</span> <span>key:Cstruct.t</span> <span>&#45;&gt;</span> <span>q:string</span> <span>&#45;&gt;</span> <span>a:Cstruct.t</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(bool * <span>int64 option</span>, <a href="index.html#type-err">err</a>)</span> Rresult.result</span></code></dt></dl></div></body></html>